<!-- Map container -->
<div id="map"></div>

<!-- Bottom bar for GPS info -->
<div id="gps-bar">
  <span id="gps-location">üìç Locating‚Ä¶</span> |
  <span id="gps-speed">‚è±Ô∏è Speed: 0 km/h</span> |
  <button onclick="toggleUnits()">Toggle Units</button>
</div>

<style>
  #map {
    height: 60vh;
    width: 100%;
  }
  #gps-bar {
    background: rgba(0,0,0,0.7);
    color: #fff;
    font-size: 14px;
    padding: 8px;
    text-align: center;
    position: relative;
    bottom: 0;
    width: 100%;
    border-top: 1px solid #333;
  }
  #gps-bar button {
    background: #444;
    border: none;
    color: #fff;
    padding: 4px 8px;
    margin-left: 6px;
    cursor: pointer;
    border-radius: 4px;
  }
</style>

<script>
  let speedUnit = "kmh"; // default

  function toggleUnits() {
    if (speedUnit === "kmh") speedUnit = "mph";
    else if (speedUnit === "mph") speedUnit = "knots";
    else speedUnit = "kmh";
  }

  function convertSpeed(ms) {
    if (speedUnit === "kmh") return (ms * 3.6).toFixed(1) + " km/h";
    if (speedUnit === "mph") return (ms * 2.23694).toFixed(1) + " mph";
    if (speedUnit === "knots") return (ms * 1.94384).toFixed(1) + " knots";
  }

  if (navigator.geolocation) {
    navigator.geolocation.watchPosition(
      pos => {
        const lat = pos.coords.latitude.toFixed(5);
        const lon = pos.coords.longitude.toFixed(5);
        document.getElementById("gps-location").textContent = `üìç ${lat}, ${lon}`;

        const speed = pos.coords.speed; // in m/s
        document.getElementById("gps-speed").textContent = 
          "‚è±Ô∏è Speed: " + (speed ? convertSpeed(speed) : "0");
      },
      err => {
        document.getElementById("gps-location").textContent = "üìç Location unavailable";
        console.error(err);
      },
      { enableHighAccuracy: true }
    );
  } else {
    document.getElementById("gps-location").textContent = "üìç Geolocation not supported";
  }
</script>
